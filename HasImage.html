<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Module: HasImage</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (H)</a> &raquo; 
    
    
    <span class="title">HasImage</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: HasImage
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/has_image.rb<span class="defines">,<br />
  lib/has_image/railtie.rb,<br /> lib/has_image/storage.rb,<br /> lib/has_image/version.rb,<br /> lib/has_image/processor.rb,<br /> lib/has_image/view_helpers.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h1>HasImage</h1>
<p>
HasImage allows you to very easily attach images to a Rails model. For some
more basic info on what it does, please see its <a
href="http://github.com/norman/has_image">project page</a> on GitHub.
</p>
<p>
Install HasImage by using Ruby Gems:
</p>
<pre class="code">
 <span class='id sudo'>sudo</span> <span class='id gem'>gem</span> <span class='id install'>install</span> <span class='id has_image'>has_image</span>
</pre>
<p>
To use HasImage in your project, you must add a varchar column to your
model. By default, this column should be named
&#8220;has_image_file,&#8221; though you may easily change this. For option
defaults, see HasImage#default_options_for and ClassMethods#has_image.
</p>
<h2>Basic Examples</h2>
<p>
Uses all default options. This works, but is likely not what you need.
</p>
<pre class="code">
 <span class='kw'>class</span> <span class='const'>Photo</span> <span class='op'>&lt;</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span>
   <span class='id has_image'>has_image</span>
 <span class='kw'>end</span>
</pre>
<p>
Resize the uploaded image to 800x800 and create a 150x150 thumbnail.
</p>
<pre class="code">
  has_image :resize_to &quot;800x800&quot;, :thumbnails =&gt; {:square =&gt; &quot;150x150&quot;}
</pre>
<p>
Resize the image and set a max file size to 4 megabytes.
</p>
<pre class="code">
  has_image :resize_to &quot;100x150&quot;, :max_size =&gt; 4.megabytes
</pre>
<h2>Some slightly more advanced examples</h2>
<h3>Localizing HasImage</h3>
<pre class="code">
 <span class='id has_image'>has_image</span> <span class='symbol'>:invalid_image_message</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No se puede procesar la imagen.</span><span class='tstring_end'>&quot;</span></span>
</pre>
<h3>Using has_image with Capistrano</h3>
<p>
When deploying using Capistrano, you will likely want to keep images under
a &#8220;system&#8221; directory so that newly deployed versions have
access to them:
</p>
<pre class="code">
  <span class='id has_image'>has_image</span> <span class='symbol'>:resize_to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>150x150</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:thumbnails</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
      <span class='symbol'>:square</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>75x75</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='symbol'>:base_path</span> <span class='op'>=&gt;</span> <span class='const'>File</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='const'>Rails</span><span class='period'>.</span><span class='id root'>root</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>public</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>system</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
</pre>
<h3>Testing with HasImage:</h3>
<p>
If you want your tests to actually run the image processing, you should
make sure your tests write the image files somewhere outside your public
directory. Add something like this to your config/environments/test.rb:
</p>
<pre class="code">
  <span class='id config'>config</span><span class='period'>.</span><span class='id after_initialize'>after_initialize</span> <span class='kw'>do</span>
    <span class='const'>MyClass</span><span class='period'>.</span><span class='id has_image_options'>has_image_options</span><span class='lbracket'>[</span><span class='symbol'>:base_path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='const'>RAILS_ROOT</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>tmp</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
</pre>
<p>
If you want to stub out calls to has_image so that your tests don&#8217;t
do the (slow) image processing, here&#8217;s an example using Test::Unit
and Mocha:
</p>
<pre class="code">
  <span class='kw'>def</span> <span class='id setup'>setup</span>
    <span class='const'>Photo</span><span class='period'>.</span><span class='id any_instance'>any_instance</span><span class='period'>.</span><span class='id stubs'>stubs</span><span class='lparen'>(</span><span class='symbol'>:image_data=</span><span class='rparen'>)</span><span class='period'>.</span><span class='id returns'>returns</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
    <span class='const'>Photo</span><span class='period'>.</span><span class='id any_instance'>any_instance</span><span class='period'>.</span><span class='id stubs'>stubs</span><span class='lparen'>(</span><span class='symbol'>:install_images</span><span class='rparen'>)</span><span class='period'>.</span><span class='id returns'>returns</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
    <span class='const'>Photo</span><span class='period'>.</span><span class='id any_instance'>any_instance</span><span class='period'>.</span><span class='id stubs'>stubs</span><span class='lparen'>(</span><span class='symbol'>:image_data_valid?</span><span class='rparen'>)</span><span class='period'>.</span><span class='id returns'>returns</span><span class='lparen'>(</span><span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>end</span></pre>


  </div>
</div>
<div class="tags">
  
</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="HasImage/ClassMethods.html" title="HasImage::ClassMethods (module)">ClassMethods</a></span>, <span class='object_link'><a href="HasImage/ModelClassMethods.html" title="HasImage::ModelClassMethods (module)">ModelClassMethods</a></span>, <span class='object_link'><a href="HasImage/ModelInstanceMethods.html" title="HasImage::ModelInstanceMethods (module)">ModelInstanceMethods</a></span>, <span class='object_link'><a href="HasImage/ViewHelpers.html" title="HasImage::ViewHelpers (module)">ViewHelpers</a></span>
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="HasImage/FileTooBigError.html" title="HasImage::FileTooBigError (class)">FileTooBigError</a></span>, <span class='object_link'><a href="HasImage/FileTooSmallError.html" title="HasImage::FileTooSmallError (class)">FileTooSmallError</a></span>, <span class='object_link'><a href="HasImage/InvalidGeometryError.html" title="HasImage::InvalidGeometryError (class)">InvalidGeometryError</a></span>, <span class='object_link'><a href="HasImage/Processor.html" title="HasImage::Processor (class)">Processor</a></span>, <span class='object_link'><a href="HasImage/ProcessorError.html" title="HasImage::ProcessorError (class)">ProcessorError</a></span>, <span class='object_link'><a href="HasImage/Railtie.html" title="HasImage::Railtie (class)">Railtie</a></span>, <span class='object_link'><a href="HasImage/Storage.html" title="HasImage::Storage (class)">Storage</a></span>, <span class='object_link'><a href="HasImage/StorageError.html" title="HasImage::StorageError (class)">StorageError</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="VERSION-constant" class="">VERSION =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0.4.0.1</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
    </dl>
  



  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_options_for-class_method" title="default_options_for (class method)">+ (Object) <strong>default_options_for</strong>(klass) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
If you&#8217;re invoking this method, you need to pass in the class for
which you want to get default options; this is used to determine the path
where the images will be stored in the file system.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enable-class_method" title="enable (class method)">+ (Object) <strong>enable</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Enables has_image functionality.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#included-class_method" title="included (class method)">+ (Object) <strong>included</strong>(base) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
:nodoc:.
</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="default_options_for-class_method">
  
    + (<tt>Object</tt>) <strong>default_options_for</strong>(klass) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
If you&#8217;re invoking this method, you need to pass in the class for
which you want to get default options; this is used to determine the path
where the images will be stored in the file system. Take a look at
HasImage::ClassMethods#has_image to see examples of how to set the options
in your model.
</p>
<p>
This method is called by your model when you call has_image. It&#8217;s
placed here rather than in the model&#8217;s class methods to make it
easier to access for testing. Unless you&#8217;re working on the code,
it&#8217;s unlikely you&#8217;ll ever need to invoke this method.
</p>
<ul>
<li><p>
:resize_to => &#8220;200x200&#8221;,
</p>
</li>
<li><p>
:thumbnails => {},
</p>
</li>
<li><p>
:auto_generate_thumbnails => true,
</p>
</li>
<li><p>
:delete => true,
</p>
</li>
<li><p>
:max_size => 12.megabytes,
</p>
</li>
<li><p>
:min_size => 4.kilobytes,
</p>
</li>
<li><p>
:path_prefix => klass.table_name,
</p>
</li>
<li><p>
:base_path => File.join(RAILS_ROOT, &#8216;public&#8217;),
</p>
</li>
<li><p>
:column => :has_image_file,
</p>
</li>
<li><p>
:convert_to => &#8220;JPEG&#8221;,
</p>
</li>
<li><p>
:output_quality => &#8220;85&#8221;,
</p>
</li>
<li><p>
:invalid_image_message => &#8220;Can&#8217;t process the image.&#8221;,
</p>
</li>
<li><p>
:image_too_small_message => &#8220;The image is too small.&#8221;,
</p>
</li>
<li><p>
:image_too_big_message => &#8220;The image is too big.&#8220;
</p>
</li>
</ul>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/has_image.rb', line 132</span>

<span class='kw'>def</span> <span class='id default_options_for'>default_options_for</span><span class='lparen'>(</span><span class='id klass'>klass</span><span class='rparen'>)</span>
  <span class='lbrace'>{</span>
    <span class='symbol'>:resize_to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>200x200</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:thumbnails</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='symbol'>:auto_generate_thumbnails</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='symbol'>:delete</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
    <span class='symbol'>:max_size</span> <span class='op'>=&gt;</span> <span class='int'>12</span><span class='period'>.</span><span class='id megabytes'>megabytes</span><span class='comma'>,</span>
    <span class='symbol'>:min_size</span> <span class='op'>=&gt;</span> <span class='int'>4</span><span class='period'>.</span><span class='id kilobytes'>kilobytes</span><span class='comma'>,</span>
    <span class='symbol'>:path_prefix</span> <span class='op'>=&gt;</span> <span class='id klass'>klass</span><span class='period'>.</span><span class='id table_name'>table_name</span><span class='comma'>,</span>
    <span class='symbol'>:base_path</span> <span class='op'>=&gt;</span> <span class='const'>File</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='const'>RAILS_ROOT</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>public</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='symbol'>:column</span> <span class='op'>=&gt;</span> <span class='symbol'>:has_image_file</span><span class='comma'>,</span>
    <span class='symbol'>:convert_to</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>JPEG</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:output_quality</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>85</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:invalid_image_message</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Can't process the image.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:image_too_small_message</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The image is too small.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='symbol'>:image_too_big_message</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The image is too big.</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="enable-class_method">
  
    + (<tt>Object</tt>) <strong>enable</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Enables has_image functionality. You probably don&#8217;t need to ever
invoke this.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/has_image.rb', line 101</span>

<span class='kw'>def</span> <span class='id enable'>enable</span> <span class='comment'># :nodoc:
</span>  <span class='kw'>return</span> <span class='kw'>if</span> <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span> <span class='symbol'>:has_image</span>
  <span class='const'>ActiveRecord</span><span class='op'>::</span><span class='const'>Base</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='symbol'>:include</span><span class='comma'>,</span> <span class='const'>HasImage</span><span class='rparen'>)</span>
  <span class='const'>ActionView</span><span class='op'>::</span><span class='const'>Base</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='symbol'>:include</span><span class='comma'>,</span> <span class='const'>ViewHelpers</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="included-class_method">
  
    + (<tt>Object</tt>) <strong>included</strong>(base) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
:nodoc:
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/has_image.rb', line 95</span>

<span class='kw'>def</span> <span class='id included'>included</span><span class='lparen'>(</span><span class='id base'>base</span><span class='rparen'>)</span> <span class='comment'># :nodoc:
</span>  <span class='id base'>base</span><span class='period'>.</span><span class='id extend'>extend</span><span class='lparen'>(</span><span class='const'>ClassMethods</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Wed Sep 29 16:15:03 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.1 (ruby-1.9.2).
</div>

  </body>
</html>